/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */
import{d as e}from"./p-7b30edcc.js";import{OVERLAY_BACK_BUTTON_PRIORITY as n,shoudUseCloseWatcher as o}from"./p-ceceac26.js";import{b as t,c as i}from"./p-5d7e32ce.js";import{C as a}from"./p-779aede8.js";import{c as d,f as r,a as s,b as l,g as c}from"./p-1b3ffb2f.js";import{p as u}from"./p-06fee233.js";let m=0,p=0;const v=new WeakMap,f=e=>({create:n=>T(e,n),dismiss:(n,o,t)=>B(document,n,o,e,t),getTop:async()=>N(document,e)}),h=f("ion-alert"),b=f("ion-action-sheet"),w=f("ion-loading"),y=f("ion-modal"),g=f("ion-picker"),k=f("ion-popover"),x=f("ion-toast"),O=e=>{"undefined"!=typeof document&&P(document);const n=m++;e.overlayIndex=n},j=e=>(e.hasAttribute("id")||(e.id="ion-overlay-"+ ++p),e.id),T=(e,n)=>"undefined"!=typeof window&&void 0!==window.customElements?window.customElements.whenDefined(e).then((()=>{const o=document.createElement(e);return o.classList.add("overlay-hidden"),Object.assign(o,Object.assign(Object.assign({},n),{hasController:!0})),V(document).appendChild(o),new Promise((e=>d(o,e)))})):Promise.resolve(),A='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',C=(e,n)=>{const o=e.querySelector(A);I(o,n)},D=(e,n)=>{const o=Array.from(e.querySelectorAll(A));I(o.length>0?o[o.length-1]:null,n)},I=(e,n)=>{let o=e;const t=null==e?void 0:e.shadowRoot;t&&(o=t.querySelector(A)||e),o?r(o):n.focus()},P=e=>{0===m&&(m=1,e.addEventListener("focus",(n=>{((e,n)=>{const o=N(n,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),t=e.target;o&&t&&(o.classList.contains("ion-disable-focus-trap")||(o.shadowRoot?(()=>{if(o.contains(t))o.lastFocus=t;else if("ION-TOAST"===t.tagName)I(o.lastFocus,o);else{const e=o.lastFocus;C(o,o),e===n.activeElement&&D(o,o),o.lastFocus=n.activeElement}})():(()=>{if(o===t)o.lastFocus=void 0;else if("ION-TOAST"===t.tagName)I(o.lastFocus,o);else{const e=c(o);if(!e.contains(t))return;const i=e.querySelector(".ion-overlay-wrapper");if(!i)return;if(i.contains(t)||t===e.querySelector("ion-backdrop"))o.lastFocus=t;else{const e=o.lastFocus;C(i,o),e===n.activeElement&&D(i,o),o.lastFocus=n.activeElement}}})()))})(n,e)}),!0),e.addEventListener("ionBackButton",(o=>{const t=N(e);(null==t?void 0:t.backdropDismiss)&&o.detail.register(n,(()=>{t.dismiss(void 0,H)}))})),o()||e.addEventListener("keydown",(n=>{if("Escape"===n.key){const n=N(e);(null==n?void 0:n.backdropDismiss)&&n.dismiss(void 0,H)}})))},B=(e,n,o,t,i)=>{const a=N(e,t,i);return a?a.dismiss(n,o):Promise.reject("overlay does not exist")},M=(e,n)=>((e,n)=>(void 0===n&&(n="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(e.querySelectorAll(n)).filter((e=>e.overlayIndex>0))))(e,n).filter((e=>!e.classList.contains("overlay-hidden"))),N=(e,n,o)=>{const t=M(e,n);return void 0===o?t[t.length-1]:t.find((e=>e.id===o))},S=(e=!1)=>{const n=V(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");n&&(e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden"))},E=async(n,o,a,d,r)=>{var s,l;if(n.presented)return;S(!0),void 0!==e&&M(e).forEach((e=>e.setAttribute("aria-hidden","true"))),n.presented=!0,n.willPresent.emit(),null===(s=n.willPresentShorthand)||void 0===s||s.emit();const c=t(n),u=n.enterAnimation?n.enterAnimation:i.get(o,"ios"===c?a:d);await z(n,u,n.el,r)&&(n.didPresent.emit(),null===(l=n.didPresentShorthand)||void 0===l||l.emit()),"ION-TOAST"!==n.el.tagName&&G(n.el),!n.keyboardClose||null!==document.activeElement&&n.el.contains(document.activeElement)||n.el.focus(),n.el.removeAttribute("aria-hidden")},G=async e=>{let n=document.activeElement;if(!n)return;const o=null==n?void 0:n.shadowRoot;o&&(n=o.querySelector(A)||n),await e.onDidDismiss(),null!==document.activeElement&&document.activeElement!==document.body||n.focus()},L=async(n,o,a,d,r,s,l)=>{var c,u,m;if(!n.presented)return!1;void 0!==e&&1===M(e).length&&S(!1),n.presented=!1;try{n.el.style.setProperty("pointer-events","none"),n.willDismiss.emit({data:o,role:a}),null===(c=n.willDismissShorthand)||void 0===c||c.emit({data:o,role:a});const e=t(n),m=n.leaveAnimation?n.leaveAnimation:i.get(d,"ios"===e?r:s);a!==J&&await z(n,m,n.el,l),n.didDismiss.emit({data:o,role:a}),null===(u=n.didDismissShorthand)||void 0===u||u.emit({data:o,role:a}),(v.get(n)||[]).forEach((e=>e.destroy())),v.delete(n),n.el.classList.add("overlay-hidden"),n.el.style.removeProperty("pointer-events"),void 0!==n.el.lastFocus&&(n.el.lastFocus=void 0)}catch(e){console.error(e)}return n.el.remove(),void 0!==e&&(null===(m=N(e))||void 0===m||m.removeAttribute("aria-hidden")),!0},V=e=>e.querySelector("ion-app")||e.body,z=async(e,n,o,t)=>{o.classList.remove("overlay-hidden");const a=n(e.el,t);e.animated&&i.getBoolean("animated",!0)||a.duration(0),e.keyboardClose&&a.beforeAddWrite((()=>{const e=o.ownerDocument.activeElement;(null==e?void 0:e.matches("input,ion-input, ion-textarea"))&&e.blur()}));const d=v.get(e)||[];return v.set(e,[...d,a]),await a.play(),!0},F=(e,n)=>{let o;const t=new Promise((e=>o=e));return W(e,n,(e=>{o(e.detail)})),t},W=(e,n,o)=>{const t=i=>{l(e,n,t),o(i)};s(e,n,t)},$=e=>"cancel"===e||e===H,_=e=>e(),q=(e,n)=>{if("function"==typeof e)return i.get("_zoneGate",_)((()=>{try{return e(n)}catch(e){throw e}}))},H="backdrop",J="gesture",K=39,Q=e=>{let n,o=!1;const t=a(),i=(i=!1)=>{if(n&&!i)return{delegate:n,inline:o};const{el:a,hasController:d,delegate:r}=e;return o=null!==a.parentNode&&!d,n=o?r||t:r,{inline:o,delegate:n}};return{attachViewToDom:async n=>{const{delegate:o}=i(!0);if(o)return await o.attachViewToDom(e.el,n);const{hasController:t}=e;if(t&&void 0!==n)throw new Error("framework delegate is missing");return null},removeViewFromDom:()=>{const{delegate:n}=i();n&&void 0!==e.el&&n.removeViewFromDom(e.el.parentElement,e.el)}}},R=()=>{let e;const n=()=>{e&&(e(),e=void 0)};return{addClickListener:(o,t)=>{n();const i=void 0!==t?document.getElementById(t):null;i?e=((e,n)=>{const o=()=>{n.present()};return e.addEventListener("click",o),()=>{e.removeEventListener("click",o)}})(i,o):u(`A trigger element with the ID "${t}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,o)},removeClickListener:n}};export{H as B,J as G,K as O,h as a,b,k as c,Q as d,R as e,E as f,L as g,F as h,$ as i,O as j,j as k,w as l,y as m,C as n,N as o,g as p,q as s,x as t}